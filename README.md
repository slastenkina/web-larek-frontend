# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура

Архитектура проекта построена на принципе MVP (Model-View-Presenter).

`Model` - слой, который работает только с данными приложения, 
`View` - слой, который только отображает эти данные на экране.
`Presenter` - между собой эти слои взаимодействуют через методы посредника.

## Базовые классы

### Класс Api
Класс обеспечивает обмен данными с сервером.
*Методы:*
- `get` -  метод для получения данных с сервера
- `post` - метод отправки данных на сервер

### Класс EventEmitter
Брокер событий, позволяет подписываться на события или слушать события. Используется в презентере для обработки.
*Методы:*
- `on` - подписаться на событие
- `off` - отписаться от события
- `emit` - инициировать событие
- `onAll` - подписаться на все события
- `offAll` - cбросить все обработчики
- `trigger` - коллбек триггер, генерирующий событие при вызове

### Класс Component
Абстрактный класс для наследования отображения, в котором содержатся общие для всех классов слоя представления методы.
*Методы:*
- `render` - вернуть корневой DOM-элемент
- `toggleClass` - переключить CSS-класс элемента
- `setText` - установить текстовое содержимое
- `setDisabled` - установить статус блокировки 'Disabled'
- `setHidden` - скрыть элемент
- `setVisible` - показать элемент
- `setImage` - установить изображение с алтернативным текстом

### Класс Model 
Абстрактный класс для компонентов модели данных. 
*Методы:*
- `emitChanges` - сообщить об изменении внутренних данных используя EventEmitter

## Слой данных

### Класс AppState
Модель данных приложения. Расширяет базовый класс Model, который принимает интерфейс IAppState. Содержит данные о корзине, каталоге товаров, заказе, прдпросмотре товара, ошибках формы.
Реализует методы упраления этими данными.
*Поля:*
- `basket`
- `catalog`
- `order`
- `preview`
- `formErrors`

## Слой представления

### Класс Modal
Класс представления модального окна.
Универсальный контейнер. В этом элементе размещается разметка, соответствующая любому контенту в проекте, который надо разместить в модальном окне: контенту информации об одном товаре, контенту корзины, контенту форм оформления заказа, контенту окна с сообщением об успешном оформлении заказа. Каждому контенту соответствует шаблон (template), присутствующий в файле index.html.
'content' - передаётся методу render класса Modal как параметр.
*Методы:*
- `render` - обновляет состояние молального окна
- `open` - открывает модальное окно
- `close` - закрывает модальное окно

### Класс Page
Класс представления главной страницы. Содержит поля: 
- `counter` - счётчик товаров в корзине
- `catalog` - каталог 
- `wrapper` - обёртка страницы, которая позволяет блокировать прокрутку страницы
- `basket` - корзина

### Класс Basket
Класс представления корзины.
Содержит поля:
- `list` - список товаров в корзине
- `total` - общая стоимость товаров в окрзине
- `button` - кнопка оформления заказа

### Класс Card
Класс представления карточки товара.
Содержит поля:
- `title` - название товара
- `image` - изображение товара
- `description` - описание товара
- `button` - кнопка карточки товара
- `price` - цена товара
- `category` - категория товара

### Класс BasketItem
Класс представления карточки товара в корзине.

### Класс Form
Класс представления формы, абстрактный класс. Обеспечивает взаимодействие с формой.
Содержит поля: 
- `submit` - кнопка отправки формы
- `errors` - отоюражение ошибок валидации
*Методы:*
- `onInputChange` - обрабатывает событие ввода данных в поля формы 
- `render` - обновляет состоние формы 

### Класс OrderPayment
Расширяет класс Form. Соответствует форме с вводом адреса доставки.
Свойства:
- `payment`
- `address`

### Класс OrderContacts
Расширяет класс Form. Соответствует форме с контактными данными.
Свойства:
- `email`
- `phone`

### Класс Success
Отображает сообщение об успешном оформлении заказа.
Свойства: 
- `total` - общая сумма заказа

## Слой презентера
Код презентера реализован в файле src/index.ts 

*События:*
- `items:changed` - изменились элементы каталога
- `card:select` - открыть карточку для просмотра подробной информации
- `preview:changed` - изменена открытая выбранная карточка
- `card:basket` - добавить товар в корзину
- `counter:changed` - изменился счётчик товаров в корзине
- `basket:open` - открыть корзину
- `basket:changed` - изменения в корзине
- `order:open` - открыть форму заказа
- `formErrors:change` - изменилось состояние валидации формы
- `/^order\..*:change/`, `/^contacts\..*:change/` - изменились поля формы
- `order:submit` - отправлена форма с оплатой заказа 
- `contacts:submit` - отправлена форма с контактами
- `modal:open` - открытие модального окна, блокировка прокрутки страницы
- `modal:close` - закрытие модального окна, разблокировка прокрутки

## Типы данных и интерфейсы

`interface ICard` - интерфейс карточки товара
	id: string; - идентификатор
	description: string; - описание
	image: string; - путь до изображения 
	title: string; - заголовок
	category: string; - категория товара
	price: number | null; - цена товара

`interface IAppState` - интерфейс приложения
	catalog: ICard[]; - каталог с товарами
	preview: string | null; - превью товара
	order: IOrder | null; - заказ
	
`type PaymentMethod` - тип способа оплаты

`interface IOrderPayment` - интерфейс для оплаты и адреса доставки

`interface IOrderContacts` - интерфейс для контактов

`interface IOrderForm` - интерфейс расширяет IOrderPayment, IOrderContacts

`interface IOrder` - интерфейс заказа, интерфейс расширяет IOrderForm

`type FormErrors` - тип ошибок валидации форм

`interface IOrderResult` - интерфейс для успешно оформленного заказа